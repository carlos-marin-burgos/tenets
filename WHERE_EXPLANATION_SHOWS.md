# ğŸ“ Where the AI Explanation Shows Up

## Visual Structure

When you run the plugin and get analysis results, the HTML structure looks like this:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š Analysis Complete                                â”‚
â”‚ Found X results                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸ Insufficient Text Contrast               [warning]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Text Layer (TEXT): Low contrast detected           â”‚
â”‚ â€¢ Increase contrast ratio                          â”‚
â”‚ â€¢ Use darker colors                                â”‚
â”‚                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚     ğŸ¤– AI Explain     â† CLICK THIS BUTTON     â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                     â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ ğŸ¤– AI Insights                    â† EXPLANATION  â”‚â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚â”‚
â”‚ â”‚ This text doesn't have enough contrast...       â”‚â”‚
â”‚ â”‚                                                  â”‚â”‚
â”‚ â”‚ ğŸ’¡ Suggestions:                                  â”‚â”‚
â”‚ â”‚ â€¢ Use darker text colors or lighter backgrounds â”‚â”‚
â”‚ â”‚ â€¢ Test contrast ratios with accessibility tools â”‚â”‚
â”‚ â”‚ â€¢ Aim for at least 4.5:1 contrast ratio         â”‚â”‚
â”‚ â”‚                                                  â”‚â”‚
â”‚ â”‚ âš ï¸ Impact: Users with visual impairments...     â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Where to Look in Figma

1. **Open your plugin** in Figma (Plugins â†’ Development â†’ UI Tenets Analyzer)

2. **Run an analysis**:

   - Click "Analyze Page" or "Analyze Selection"
   - You'll see result cards appear

3. **Each result card contains**:

   - ğŸ“ Title (e.g., "Insufficient Text Contrast")
   - ğŸ·ï¸ Status badge (warning/error/info)
   - ğŸ“„ Description text
   - ğŸ¤– "AI Explain" button
   - ğŸ“¦ **Hidden explanation div** (initially `display: none`)

4. **When you click "ğŸ¤– AI Explain"**:
   - Button text changes to "ğŸ¤– Loading..."
   - After 1-3 seconds, the explanation appears **DIRECTLY BELOW** the button
   - It has a purple/blue gradient background with a border
   - Button changes to "âœ… AI Explained"

## What You Should See

### Location in the DOM:

```html
<div class="result-item">
  <div class="result-header">
    <h4>Violation Title</h4>
    <span class="result-status">warning</span>
  </div>
  <div class="result-details">
    <p>Description...</p>
    <ul>
      Recommendations...
    </ul>

    <!-- BUTTON HERE -->
    <button class="ai-explain-btn">ğŸ¤– AI Explain</button>

    <!-- EXPLANATION APPEARS HERE (initially hidden) -->
    <div class="ai-explanation" id="ai-explanation-0" style="display: none;">
      <!-- After clicking, this fills with content -->
    </div>
  </div>
</div>
```

## Debugging - What to Check

### In Figma Console (Plugins â†’ Development â†’ Open Console):

After clicking "AI Explain", you should see these logs **in order**:

```
1. ğŸ¤– AI Explain button clicked
2. ğŸ” Button click details: { resultIndex: "0", ... }
3. ğŸ“¤ Sending AI explanation request: { violation: {...}, resultIndex: 0 }
4. âœ… Message sent to parent window

--- Plugin side ---
5. ğŸ¤– Starting AI explanation for: {...}
6. ğŸ”‘ No API key provided, using fallback explanation (or AI response)
7. âœ… AI explanation received: {...}
8. ğŸ“¤ Sending AI explanation to UI...

--- UI side ---
9. ğŸ“¨ Received ai-explanation-complete: {...}
10. ğŸ¯ showAIExplanation called with: {...}
11. ğŸ” Looking for result index: "0"
12. ğŸ” Button found: true
13. ğŸ” Result item found: true
14. ğŸ” Explanation div found: true
15. ğŸ” Explanation div ID: "ai-explanation-0"
16. âœ… All elements found, calling showExplanationContent...
17. âœ… Showing AI explanation for result index: 0
18. âœ… Explanation HTML set, innerHTML length: 842
19. âœ… After setting display: block
20. âœ… Button updated to 'AI Explained' state
```

### If explanation doesn't show:

1. **Check if any of these logs fail**:

   - âŒ Button not found â†’ The button wasn't created properly
   - âŒ Result item not found â†’ DOM structure issue
   - âŒ Explanation div not found â†’ The div wasn't created

2. **Check the explanation div in DOM**:

   - Right-click in plugin â†’ Inspect Element
   - Find `<div class="ai-explanation" id="ai-explanation-0">`
   - Check its `style.display` - should be `block` after clicking
   - Check its `innerHTML` - should have content

3. **Common Issues**:
   - **Nothing happens**: Check if request even reaches the plugin (look for log #5)
   - **"Failed - Retry?"**: Request timed out or error occurred
   - **Button changes but no explanation**: The div exists but isn't visible (check CSS)

## Visual Appearance

The explanation should have:

- ğŸ¨ **Purple/blue gradient background** (rgba(102, 126, 234, 0.15))
- ğŸ”² **Blue border** (2px solid #667eea)
- ğŸ“ **Padding** (16px all around)
- ğŸ” **Margin top** (12px from button)
- ğŸ“ **Three sections**:
  1. Heading: "ğŸ¤– AI Insights"
  2. Explanation text
  3. Suggestions list
  4. Impact statement

## Expected Flow Time

- **Button click** â†’ 0ms
- **"Loading..." appears** â†’ 0ms (immediate)
- **Request sent** â†’ <10ms
- **AI Service processes** â†’ 100-3000ms
- **Response received** â†’ <10ms
- **Explanation displayed** â†’ <10ms
- **"AI Explained" button** â†’ 0ms (immediate)

**Total: 0.1-3 seconds from click to display**

## Still Not Seeing It?

Try these:

1. **Scroll down in the plugin window** - explanation might be below viewport
2. **Look for the purple box** - it has a distinctive color
3. **Check if button says "âœ… AI Explained"** - if yes, explanation should be there
4. **Inspect the element** - find `ai-explanation-0` and check its styles
5. **Check console for errors** - look for any âŒ messages

---

**The explanation appears DIRECTLY BELOW the "ğŸ¤– AI Explain" button in each result card!**
